function Timer(){function e(e,r,n,o,i,a,u,m){if("boolean"==typeof e?(m=e,e=Timer.DEFAULT_TIME):"boolean"==typeof r?(m=r,r=Timer.DEFAULT_INTERVAL):"boolean"==typeof n?(m=n,n=Timer.DEFAULT_PLAYSTATE):"boolean"==typeof o?(m=o,o=Timer.DEFAULT_BOTTOM):"boolean"==typeof u&&(m=u,u=Timer.DEFAULT_SPEED),e<y.bottom||e>y.top)throw new TypeError("time lies outside of the available range of the timer");y.bottom="number"==typeof o?o:Timer.DEFAULT_BOTTOM,h.bottom=y.bottom,y.loop="boolean"==typeof a?a:Timer.DEFAULT_LOOP,h.loop=y.loop,y.speed="number"==typeof u?u:Timer.DEFAULT_SPEED,h.speed=y.speed,y.interval="number"==typeof r?r:Timer.DEFAULT_INTERVAL,h.interval=y.interval,y.time="number"==typeof e?e:Timer.DEFAULT_TIME,h.time=y.time,y.top="number"==typeof i?i:Timer.DEFAULT_TOP,h.top=y.top,M="number"==typeof n?n:Timer.DEFAULT_PLAYSTATE,h.state=M,w="boolean"==typeof m?m:Timer.DEFAULT_RAISES_EVENTS,y.state==Timer.PLAYING&&t()}function t(){O=y.time,s=Date.now(),M=Timer.PLAYING,U=h.speed,b(),d(new TimerEvent("play",y,O))}function r(){O=y.time,s=Date.now(),M=Timer.STOPPED,f(),c(),d(new TimerEvent("stop",y,O))}function n(){O=h.time,s=Date.now(),M=Timer.STOPPED,f(),c(),d(new TimerEvent("stop",y,O)),d(new TimerEvent("reset",y,O))}function o(){O=h.time,s=Date.now(),c(),d(new TimerEvent("reset",y,O))}function i(){O=y.time,s=Date.now(),M=Timer.PLAYING,U=2*h.speed,b(),d(new TimerEvent("play",y,O))}function a(){O=y.time,s=Date.now(),M=Timer.PLAYING,U=-1*h.speed,b(),d(new TimerEvent("play",y,O))}function u(){O=y.time,s=Date.now(),M=Timer.PLAYING,U=-2*h.speed,b(),d(new TimerEvent("play",y,O))}function m(e,t){var r=e;return r instanceof TimerMarker||(r=new TimerMarker(e,t)),A.push(r),A.length-1}function l(e){A[e]=null}function b(){null==j&&w&&(j=window.setInterval(c,Timer.PRECISION))}function f(){null!==j&&window.clearInterval(j),j=null}function c(){var e=y.time;d(new TimerEvent("update",y));var t=T(e);p(e,t),v(e,t),L=e}function T(e){var t=!1,r=M;return e>=g&&(t=!0,d(new TimerEvent("top",y,g)),I&&r?(O=_+(e-g),s=Date.now(),d(new TimerEvent("bottom",y,_))):r&&(e=g,O=g,s=Date.now(),M=Timer.STOPPED,f(),d(new TimerEvent("stop",y,g)))),_>=e&&!t&&(t=!0,d(new TimerEvent("bottom",y,_)),I&&r?(O=g-(_-e),s=Date.now(),d(new TimerEvent("top",y,g))):r&&(e=_,O=_,s=Date.now(),M=Timer.STOPPED,f(),d(new TimerEvent("stop",y,_)))),t}function p(e,t){var r=L%k,n=y.time%k;U>0&&M>0?r>n&&d(new TimerEvent("tick",y,e)):0>U&&M>0&&n>r&&d(new TimerEvent("tick",y,e))}function v(e,t){for(var r=0;r<A.length;r++){var n=A[r];if(U>0&&(M>0||t)&&n){if(L<n.time&&e>n.time||e==n.time){var o=new TimerEvent("marker",n);n.callback&&n.callback(o),d(o)}}else if(0>U&&(M>0||t)&&n&&(L>n.time&&e<n.time||e==n.time)){var o=new TimerEvent("marker",n);n.callback&&n.callback(o),d(o)}}}function E(e,t,r){e in S||(S[e]=[]),S[e].push(t)}function P(e,t,r){if(e in S)for(var n=S[e],o=0;o<n.length;o++)if(n[o]===t)return void n.splice(o,1)}function d(e){if(!(e.type in S))return!0;var t=S[e.type];e.target=y,t.on&&t.on.call(y,e);for(var r=0;r<t.length;r++)t[r].call(y,e);return!e.defaultPrevented}const y=this;var O,s,D,j=null,A=[],L=0,w,h={},F={};Object.defineProperty(y,"bottom",{get:function(){return _},set:function(e){_="number"==typeof e?Math.toZero(e):Timer.DEFAULT_BOTTOM},enumerable:!0});var _=Timer.DEFAULT_BOTTOM;Object.defineProperty(y,"loop",{get:function(){return I},set:function(e){I=!!e},enumerable:!0});var I=null;Object.defineProperty(y,"speed",{get:function(){return U},set:function(e){O=Math.toZero(y.time),s=Date.now(),U=e?e:Timer.DEFAULT_SPEED},enumerable:!0});var U=Timer.DEFAULT_SPEED;Object.defineProperty(y,"state",{get:function(){return M},enumerable:!0});var M=0;Object.defineProperty(y,"top",{get:function(){return g},set:function(e){g=e?Math.toZero(e):Timer.DEFAULT_TOP},enumerable:!0});var g=Timer.DEFAULT_TOP;Object.defineProperty(y,"interval",{get:function(){return k},set:function(e){k=e?Math.max(1,e):Timer.DEFAULT_INTERVAL},enumerable:!0});var k=Timer.DEFAULT_INTERVAL;Object.defineProperty(y,"time",{get:function(){var e=Math.toZero(O+(Date.now()-s)*(U*Math.min(M,1)));return e=Math.max(_,Math.min(g,e)),isNaN(e)?h.time:e},set:function(e){if(_>e||e>g)throw new TypeError("time lies outside of the available range of the timer");O=Math.toZero(e),s=Date.now(),c()},enumerable:!0}),Object.defineProperty(y,"play",{value:t,enumerable:!0}),Object.defineProperty(y,"pause",{value:r,enumerable:!0}),Object.defineProperty(y,"stop",{value:n,enumerable:!0}),Object.defineProperty(y,"reset",{value:o,enumerable:!0}),Object.defineProperty(y,"fastForward",{value:i,enumerable:!0}),Object.defineProperty(y,"playBackward",{value:a,enumerable:!0}),Object.defineProperty(y,"fastBackward",{value:u,enumerable:!0}),Object.defineProperty(y,"addMarker",{value:m,enumerable:!0}),Object.defineProperty(y,"removeMarker",{value:l,enumerable:!0});var N=0,S={bottom:[],marker:[],play:[],reset:[],stop:[],tick:[],top:[],update:[]};Object.defineProperty(y,"addEventListener",{value:E,enumerable:!0}),Object.defineProperty(y,"removeEventListener",{value:P,enumerable:!0}),Object.defineProperty(y,"dispatchEvent",{value:d,enumerable:!0}),Object.defineProperty(y,"onbottom",{get:function(){return S.bottom.on},set:function(e){S.bottom.on=e},enumerable:!0}),Object.defineProperty(y,"onmarker",{get:function(){return S.marker.on},set:function(e){S.marker.on=e},enumerable:!0}),Object.defineProperty(y,"onplay",{get:function(){return S.play.on},set:function(e){S.play.on=e},enumerable:!0}),Object.defineProperty(y,"onreset",{get:function(){return S.reset.on},set:function(e){S.reset.on=e},enumerable:!0}),Object.defineProperty(y,"onstop",{get:function(){return S.stop.on},set:function(e){S.stop.on=e},enumerable:!0}),Object.defineProperty(y,"ontick",{get:function(){return S.tick.on},set:function(e){S.tick.on=e},enumerable:!0}),Object.defineProperty(y,"ontop",{get:function(){return S.top.on},set:function(e){S.top.on=e},enumerable:!0}),Object.defineProperty(y,"onupdate",{get:function(){return S.update.on},set:function(e){S.update.on=e},enumerable:!0}),e.apply(y,arguments)}function TimerEvent(e,t,r){const n=this;var r="number"==typeof r?r:t.time;Object.defineProperty(n,"bubbles",{value:!1,enumerable:!0}),Object.defineProperty(n,"cancelBubble",{value:!1,enumerable:!0}),Object.defineProperty(n,"cancelable",{value:!1,enumerable:!0}),Object.defineProperty(n,"composed",{value:!1,enumerable:!0}),Object.defineProperty(n,"currentTarget",{value:!1,enumerable:!0}),Object.defineProperty(n,"defaultPrevented",{value:!1,enumerable:!0}),Object.defineProperty(n,"eventPhase",{value:0,enumerable:!0}),Object.defineProperty(n,"isTrusted",{value:!0,enumerable:!0}),Object.defineProperty(n,"path",{value:[],enumerable:!0}),Object.defineProperty(n,"returnValue",{value:r,enumerable:!0}),Object.defineProperty(n,"srcElement",{value:t,enumerable:!0}),Object.defineProperty(n,"target",{value:t,enumerable:!0}),Object.defineProperty(n,"timeStamp",{value:Date.now(),enumerable:!0}),Object.defineProperty(n,"type",{value:e,enumerable:!0})}function TimerMarker(e,t){const r=this;var n=e,o=t;Object.defineProperty(r,"time",{get:function(){return n},enumerable:!0}),Object.defineProperty(r,"callback",{get:function(){return o},enumerable:!0})}Object.defineProperty(Timer,"PRECISION",{value:1,enumerable:!0}),Object.defineProperty(Timer,"STOPPED",{value:0,enumerable:!0}),Object.defineProperty(Timer,"PLAYING",{value:1,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_TIME",{value:0,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_INTERVAL",{value:1e3,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_PLAYSTATE",{value:Timer.STOPPED,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_SPEED",{value:1,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_BOTTOM",{value:Number.NEGATIVE_INFINITY,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_TOP",{value:Number.POSITIVE_INFINITY,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_LOOP",{value:!1,enumerable:!0}),Object.defineProperty(Timer,"DEFAULT_RAISES_EVENTS",{value:!0,enumerable:!0}),function(){function e(e){return 0>e?Math.ceil(e):Math.floor(e)}"undefined"==typeof Math.toZero?Math.toZero=e:console.error("Monkey Patch Failed: Math.toZero is already defined.")}();
